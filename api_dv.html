<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zzjavascript</title>
</head>
<body onload="usePromise()">
    <h1>PromiseTest</h1>







</body>
<script>

    let promError = false;

    function getPromise() {
        return new Promise((resolve, reject) => {
            setTimeout (() => {
                if(promError){
                    reject("hat nicht geklappt");
                } else {
                    resolve("hat geklappt");
                }
            }, 300);
        });
    }

    async function usePromise() {
        let prom = "nothing happened";
        try {
            prom = await getPromise();
        } catch (error) {
            console.log(error);
        }
        console.log(prom);
    }

    //////////////////////////////////// 05 - Promise: then ///////////////////////////////////////

    function getgoodPromise() {
        return new Promise((resolve, reject) => {
            setTimeout (() => {
                console.log("good");      
                resolve("hat geklappt");
            }, 1000);
        });
    }

    function getbadPromise() {
        return new Promise((resolve, reject) => {
            setTimeout (() => {
                console.log("bad");
                reject("done_bad");
            }, 1000);
        });
    }

    function usePromise2() {
        getgoodPromise().then(
            (result) => {
                console.log(result);
            }
        ).then(
            getgoodPromise
        ).catch((error) => {
            console.log(error);
        })
    }

////////////////////then ist die alte Version von catch // then == catch

    async function fetchDataJson() {
        let response = await fetch('db.json');
        let responseAsJson = await response.json();
        console.log(response);
    }

    async function fetchDataText() {
        let response = await fetch('db.txt');
        let responseAsText = await response.text();
        document.getElementById("content").innerHTML = responseAsText;
    }
</script>
</html>